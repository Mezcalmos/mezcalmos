table:
  name: order_request
  schema: business
object_relationships:
  - name: business
    using:
      foreign_key_constraint_on: business_id
  - name: chat
    using:
      foreign_key_constraint_on: chat_id
  - name: customer
    using:
      foreign_key_constraint_on: customer_id
array_relationships:
  - name: items
    using:
      foreign_key_constraint_on:
        column: order_request_id
        table:
          name: order_request_item
          schema: business
computed_fields:
  - name: cost
    definition:
      function:
        name: ordercost
        schema: business
select_permissions:
  - role: business_operator
    permission:
      columns:
        - business_id
        - chat_id
        - customer_id
        - id
        - review_id
        - customer_app_type
        - notes
        - status
        - cancellation_time
        - order_time
      computed_fields:
        - cost
      filter:
        business:
          operators:
            user_id:
              _eq: X-Hasura-User-Id
  - role: customer
    permission:
      columns:
        - business_id
        - chat_id
        - customer_id
        - id
        - review_id
        - customer_app_type
        - notes
        - status
        - cancellation_time
        - order_time
      computed_fields:
        - cost
      filter:
        customer:
          user_id:
            _eq: X-Hasura-User-Id
  - role: mez_admin
    permission:
      columns:
        - business_id
        - chat_id
        - customer_id
        - id
        - review_id
        - customer_app_type
        - notes
        - status
        - cancellation_time
        - order_time
      computed_fields:
        - cost
      filter:
        _exists:
          _table:
            name: mez_admin
            schema: public
          _where:
            user_id:
              _eq: X-Hasura-User-Id
