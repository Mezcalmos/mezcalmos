query get_service_by_id($id: Int!) {
  business_service_by_pk(id: $id) {
    business {
      id
      details {
        id
        accepted_payments
        image
        name
      }
      reviews_aggregate {
        aggregate {
          avg {
            rating
          }
          count
        }
      }
    }
    details {
      additional_parameters
      available
      category1
      name_id
      description_id
      category2
      cost
      tags
      description {
        translations {
          language_id
          value
        }
      }
      id
      image
      name {
        translations {
          language_id
          value
        }
      }
    }
  }
}

query get_service_by_category($categories1: [String!], $distance: Float!, $from: geography!, $limit: Int, $offset: Int, $categories2: [String!], $tags: [String!]) {
  business_service(
    where: {
      _and: {
        details: {
          _and: {
            category1: {
              _in: $categories1
            }, 
            category2: {
              _in: $categories2
            },
            tags: {_has_keys_all: $tags}
          }
        },
        business: {
          details: {
            location: {
              gps: {
                _st_d_within: {
                  distance: $distance, 
                  from: $from
                }
              }
            }
          }
        }
      }
    }, limit: $limit, offset: $offset) {
    details {
      id
      name {
        translations {
          language_id
          value
        }
      }
      additional_parameters
      available
      category1
      cost
      tags
      image
      position
    }
    id
    business {
      id
      details {
        id
        name
        location {
          gps
          address
        }
      }
    }
  }
}

query number_of_services($distance: Float!, $from: geography!) {
  business_service_aggregate(where: {business: {details: {location: {gps: {_st_d_within: {distance: $distance, from: $from}}}}}}) {
    aggregate {
      count
    }
  }
}

query number_of_services_by_category($distance: Float!, $from: geography!, $category1: String) {
  business_service_aggregate(where: {business: {details: {location: {gps: {_st_d_within: {distance: $distance, from: $from}}}}}, details: {category1: {_eq: $category1}}}) {
    aggregate {
      count
    }
  }
}


mutation add_service($object: business_service_insert_input!) {
  insert_business_service_one(object: $object) {
    details_id
    id
  }
}
