mutation updateBsOrderItem(
  $id: Int!
  $data: business_order_request_item_set_input!
) {
  update_business_order_request_item_by_pk(
    pk_columns: { id: $id }
    _set: $data
  ) {
    available
    cost
    id
    item_id
    parameters
    order_request_id
    offering_type
    time
  }
}

query getHomeRentalOrderRequest($orderId: Int!) {
  business_order_request_by_pk(id: $orderId) {
    business_id

    customer_id
    customer_app_type
    business {
      details_id
    }
    customer {
      user_id
      user {
        name
        firebase_id
        image
      }
    }
    chat_id
    cost
    status
    review_id
    order_time
    notes
    id
    items {
      available
      cost
      order_request_id
      offering_type
      item_id
      id
      parameters
      rental {
        id
        details {
          id
          name {
            translations {
              language_id
              value
            }
          }
          additional_parameters

          category1
          category2
          cost
          image
          position
          tags
        }
      }
      time
    }
  }
}


query getBsOrders($busnessId: Int!,$status: String) {
  business_order_request(
    where: { business_id: { _eq: $busnessId }, status: { _eq: $status } }
  ) {
    customer {
      user_id
      user {
        name
        firebase_id
        image
      }
    }

    cost
    status

    order_time

    id
    items {
      id

      time
    }
  }
}
subscription listenToBsOrders($busnessId: Int!,$status: String!) {
  business_order_request(
    where: { business_id: { _eq: $busnessId }, status: { _eq: $status } }
  ) {
    customer {
      user_id
      user {
        name
        firebase_id
        image
      }
    }

    cost
    status

    order_time

    id
    items {
      id

      time
    }
  }
}
query getBsRentalUpcomingOrdersItems(
  $rentalBusinessId: Int!
  $offset: Int!
  $limit: Int!
) {
  business_order_request_item(
    where: {
      _and: [
        { order: { business_id: { _eq: $rentalBusinessId } } }
        {
          order: {
            _and: [
              { status: { _neq: "cancelledByBusiness" } }
              { status: { _neq: "cancelledByCustomer" } }
              { status: { _neq: "requestReceived" } }
            ]
          }
        }
        { time: { _gte: "now()" } }
      ]
    }
    limit: $limit
    offset: $offset
  ) {
    cost

    order_request_id
    parameters
    order {
      customer {
        user {
          name
        }
      }
    }
    time
    rental {
      details {
        image
        name {
          translations {
            language_id
            value
          }
        }
      }
    }
    home {
      details {
        image
        name {
          translations {
            language_id
            value
          }
        }
      }
    }
    event {
      details {
        image
        name {
          translations {
            language_id
            value
          }
        }
      }
    }
    service {
      details {
        image
        name {
          translations {
            language_id
            value
          }
        }
      }
    }
    product {
      details {
        image
        name {
          translations {
            language_id
            value
          }
        }
      }
    }
  }
}

query getBsRentalPastOrdersItems(
  $rentalBusinessId: Int!
  $offset: Int!
  $limit: Int!
) {
  business_order_request_item(
    where: {
      _and: [
        { order: { business_id: { _eq: $rentalBusinessId } } }
        {
          _or: [
            { time: { _lte: "now()" } }
            { order: { status: { _eq: "cancelledByBusiness" } } }
            { order: { status: { _eq: "cancelledByCustomer" } } }
          ]
        }
        { order: { status: { _neq: "requestReceived" } } }
      ]
    }
    limit: $limit
    offset: $offset
  ) {
    cost
    order_request_id
    parameters
    order {
      customer {
        user {
          name
        }
      }
    }
    time
    rental {
      details {
        image
        name {
          translations {
            language_id
            value
          }
        }
      }
    }
    home {
      details {
        image
        name {
          translations {
            language_id
            value
          }
        }
      }
    }
    event {
      details {
        image
        name {
          translations {
            language_id
            value
          }
        }
      }
    }
    service {
      details {
        image
        name {
          translations {
            language_id
            value
          }
        }
      }
    }
    product {
      details {
        image
        name {
          translations {
            language_id
            value
          }
        }
      }
    }
  }
}

query number_of_customer_business_orders($customer_id: Int, $business_id: Int) {
  business_order_request_aggregate(where: {customer_id: {_eq: $customer_id}, business_id: {_eq: $business_id}}) {
    aggregate {
      count
    }
  }
}