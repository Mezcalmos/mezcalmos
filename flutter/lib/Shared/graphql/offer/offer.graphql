query get_service_provider_offers(
  $service_provider_id: Int
  $service_provider_type: String
) {
  service_provider_offer(
    where: {
      service_provider_id: { _eq: $service_provider_id }
      service_provider_type: { _eq: $service_provider_type }
    }
  ) {
    id
    details
    name {
      translations {
        language_id
        value
      }
    }
    status
    coupon_code
    offer_type
  }
}

query check_coupon(
  $coupon_code: String
  $service_provider_id: Int
  $service_provider_type: String
) {
  service_provider_offer(
    where: {
      coupon_code: { _eq: $coupon_code }
      service_provider_id: { _eq: $service_provider_id }
      service_provider_type: { _eq: $service_provider_type }
      status: { _eq: "active" }
      offer_type: { _eq: "coupon" }
    }
  ) {
    id
    details
  }
}

query check_offer_applied(
  $offer_id: Int
  $customer_id: Int
  $order_type: String
) {
  service_provider_offer_applied(
    where: {
      offer_id: { _eq: $offer_id }
      order_type: { _eq: $order_type }
      _or: [
        { business_order: { customer_id: { _eq: $customer_id } } }
        { restaurant_order: { customer_id: { _eq: $customer_id } } }
        { laundry_order: { customer_id: { _eq: $customer_id } } }
      ]
    }
  ) {
    order_id
  }
}

query fetchPromotions(
  $service_provider_id: Int
  $service_provider_type: String
) {
  service_provider_offer(
    where: {
      offer_type: { _eq: "promotion" }
      service_provider_id: { _eq: $service_provider_id }
      service_provider_type: { _eq: $service_provider_type }
      status: { _eq: "active" }
    }
  ) {
    details
    id
    name {
      translations {
        language_id
        value
      }
    }
    name_id
  }
}
